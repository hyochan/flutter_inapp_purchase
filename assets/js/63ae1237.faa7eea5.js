"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[71],{28453:(e,r,s)=>{s.d(r,{R:()=>c,x:()=>d});var t=s(96540);const n={},i=t.createContext(n);function c(e){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),t.createElement(i.Provider,{value:r},e.children)}},54058:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"api/methods/get-products","title":"fetchProducts","description":"fetchProducts() is the unified way to load in-app products or subscriptions from the store, consolidating the legacy helpers into a single API.","source":"@site/versioned_docs/version-6.7/api/methods/get-products.md","sourceDirName":"api/methods","slug":"/api/methods/get-products","permalink":"/flutter_inapp_purchase/6.7/api/methods/get-products","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/versioned_docs/version-6.7/api/methods/get-products.md","tags":[],"version":"6.7","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"fetchProducts"}}');var n=s(74848),i=s(28453);const c={sidebar_position:2,title:"fetchProducts"},d="fetchProducts()",o={},l=[{value:"Signature",id:"signature",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Return Value",id:"return-value",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Fetch in-app products",id:"fetch-in-app-products",level:3},{value:"Fetch subscriptions",id:"fetch-subscriptions",level:3},{value:"Fetch both types",id:"fetch-both-types",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Platform Notes",id:"platform-notes",level:2},{value:"iOS",id:"ios",level:3},{value:"Android",id:"android",level:3},{value:"Migration Notes",id:"migration-notes",level:2},{value:"Related APIs",id:"related-apis",level:2},{value:"See Also",id:"see-also",level:2}];function a(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"fetchproducts",children:"fetchProducts()"})}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.code,{children:"fetchProducts()"})," is the unified way to load in-app products or subscriptions from the store, consolidating the legacy helpers into a single API."]}),"\n",(0,n.jsx)(r.h2,{id:"signature",children:"Signature"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-dart",children:"Future<FetchProductsResult> fetchProducts(ProductRequest params)\n"})}),"\n",(0,n.jsx)(r.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Parameter"}),(0,n.jsx)(r.th,{children:"Type"}),(0,n.jsx)(r.th,{children:"Required"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"params.skus"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"List<String>"})}),(0,n.jsx)(r.td,{children:"\u2705"}),(0,n.jsx)(r.td,{children:"Store identifiers to query (Google Play product IDs / App Store product identifiers)"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"params.type"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ProductQueryType?"})}),(0,n.jsx)(r.td,{children:"\u274c"}),(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.code,{children:"ProductQueryType.InApp"})," (default) or ",(0,n.jsx)(r.code,{children:"ProductQueryType.Subs"})]})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"return-value",children:"Return Value"}),"\n",(0,n.jsxs)(r.p,{children:["The method resolves to a ",(0,n.jsx)(r.code,{children:"FetchProductsResult"})," sealed type:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"FetchProductsResultProducts"})," \u2013 wraps a ",(0,n.jsx)(r.code,{children:"List<Product>"})," when querying in-app items"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"FetchProductsResultSubscriptions"})," \u2013 wraps a ",(0,n.jsx)(r.code,{children:"List<ProductSubscription>"})," when querying subscriptions"]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["Use the helper extensions from ",(0,n.jsx)(r.code,{children:"package:flutter_inapp_purchase/flutter_inapp_purchase.dart"})," (",(0,n.jsx)(r.code,{children:"result.inAppProducts()"}),", ",(0,n.jsx)(r.code,{children:"result.subscriptionProducts()"}),", ",(0,n.jsx)(r.code,{children:"result.allProducts()"}),") to convert the union into strongly typed lists."]}),"\n",(0,n.jsx)(r.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,n.jsx)(r.h3,{id:"fetch-in-app-products",children:"Fetch in-app products"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-dart",children:"final result = await FlutterInappPurchase.instance.fetchProducts(\n  ProductRequest(\n    skus: ['coins_100', 'remove_ads'],\n    type: ProductQueryType.InApp,\n  ),\n);\n\nfinal products = result.inAppProducts();\nfor (final product in products) {\n  print('${product.title}: ${product.displayPrice}');\n}\n"})}),"\n",(0,n.jsx)(r.h3,{id:"fetch-subscriptions",children:"Fetch subscriptions"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-dart",children:"final result = await FlutterInappPurchase.instance.fetchProducts(\n  ProductRequest(\n    skus: ['premium_monthly', 'premium_yearly'],\n    type: ProductQueryType.Subs,\n  ),\n);\n\nfinal subscriptions = result.subscriptionProducts();\nfor (final sub in subscriptions) {\n  print('${sub.title}: ${sub.displayPrice}');\n  print('Period: ${sub.subscriptionPeriodUnitIOS ?? sub.subscriptionInfoAndroid?.billingPeriod}');\n}\n"})}),"\n",(0,n.jsx)(r.h3,{id:"fetch-both-types",children:"Fetch both types"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-dart",children:"Future<void> loadCatalog() async {\n  final inApps = await FlutterInappPurchase.instance.fetchProducts(\n    ProductRequest(skus: ['coins_100', 'remove_ads'], type: ProductQueryType.InApp),\n  );\n  final subs = await FlutterInappPurchase.instance.fetchProducts(\n    ProductRequest(skus: ['premium_monthly'], type: ProductQueryType.Subs),\n  );\n\n  final allProducts = [\n    ...inApps.allProducts(),\n    ...subs.allProducts(),\n  ];\n\n  for (final item in allProducts) {\n    debugPrint('Loaded ${item.id} (${item.displayPrice})');\n  }\n}\n"})}),"\n",(0,n.jsx)(r.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-dart",children:"try {\n  final result = await FlutterInappPurchase.instance.fetchProducts(\n    ProductRequest(skus: productIds, type: ProductQueryType.InApp),\n  );\n\n  final products = result.inAppProducts();\n  if (products.isEmpty) {\n    debugPrint('No products returned for: $productIds');\n  }\n} on PurchaseError catch (error) {\n  switch (error.code) {\n    case ErrorCode.NotPrepared:\n      debugPrint('Call initConnection() before fetching products');\n      break;\n    case ErrorCode.NetworkError:\n      debugPrint('Network error \u2013 prompt the user to retry');\n      break;\n    default:\n      debugPrint('Unexpected store error: ${error.message}');\n  }\n}\n"})}),"\n",(0,n.jsx)(r.h2,{id:"platform-notes",children:"Platform Notes"}),"\n",(0,n.jsx)(r.h3,{id:"ios",children:"iOS"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Products must be visible in App Store Connect (Ready for Sale or Approved)"}),"\n",(0,n.jsx)(r.li,{children:"The bundle identifier must match the app querying the products"}),"\n",(0,n.jsx)(r.li,{children:"StoreKit 2 caching means results may be served from a local cache on subsequent calls"}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"android",children:"Android"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Products must be active in Google Play Console (Internal Testing track or above)"}),"\n",(0,n.jsx)(r.li,{children:"Billing client v8 requires the app to be signed with a certificate added to Play Console"}),"\n",(0,n.jsx)(r.li,{children:"Only SKUs that belong to the current package can be queried"}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"migration-notes",children:"Migration Notes"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Replace ",(0,n.jsx)(r.code,{children:"requestProducts()"})," calls with ",(0,n.jsx)(r.code,{children:"fetchProducts(ProductRequest(...))"})]}),"\n",(0,n.jsxs)(r.li,{children:["Convert the returned ",(0,n.jsx)(r.code,{children:"FetchProductsResult"})," using ",(0,n.jsx)(r.code,{children:"inAppProducts()"}),", ",(0,n.jsx)(r.code,{children:"subscriptionProducts()"}),", or ",(0,n.jsx)(r.code,{children:"allProducts()"})," depending on the query type"]}),"\n",(0,n.jsxs)(r.li,{children:["Replace any legacy product-loading helpers in your codebase with ",(0,n.jsx)(r.code,{children:"fetchProducts()"})]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"related-apis",children:"Related APIs"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"./request-purchase",children:(0,n.jsx)(r.code,{children:"requestPurchase()"})})," \u2013 Start the purchase flow"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"./get-available-purchases",children:(0,n.jsx)(r.code,{children:"getAvailablePurchases()"})})," \u2013 Restore owned items"]}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsxs)(r.a,{href:"../../guides/products#fetchproducts-helper-extensions",children:[(0,n.jsx)(r.code,{children:"fetchProducts()"})," helper extensions"]})}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"see-also",children:"See Also"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"../../guides/products",children:"Products Guide"})," \u2013 Designing product catalogs"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"../../guides/subscriptions",children:"Subscriptions Guide"})," \u2013 Subscription-specific flows"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"../../troubleshooting",children:"Troubleshooting"})," \u2013 Diagnostics for common failures"]}),"\n"]})]})}function u(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}}}]);