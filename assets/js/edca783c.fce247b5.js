"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[7755],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>o});var r=i(96540);const a={},l=r.createContext(a);function s(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(l.Provider,{value:n},e.children)}},44307:e=>{e.exports=JSON.parse('{"permalink":"/flutter_inapp_purchase/blog/8.0.0-release","editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/blog/2025-12-16-8.0.0.release.md","source":"@site/blog/2025-12-16-8.0.0.release.md","title":"8.0.0 - Google Play Billing 8.2.0 Features","description":"We\'re excited to announce flutterinapppurchase v8.0.0, bringing support for Google Play Billing Library 8.2.0 features including the Billing Programs API, one-time product discounts, and purchase suspension status.","date":"2025-12-16T00:00:00.000Z","tags":[{"inline":false,"label":"Release","permalink":"/flutter_inapp_purchase/blog/tags/release","description":"New version releases and updates"},{"inline":false,"label":"Billing Programs","permalink":"/flutter_inapp_purchase/blog/tags/billing-programs","description":"Google Play Billing Programs API features"},{"inline":false,"label":"Breaking Change","permalink":"/flutter_inapp_purchase/blog/tags/breaking-change","description":"Breaking changes and migration guides"}],"readingTime":2.73,"hasTruncateMarker":true,"authors":[{"name":"Hyo","title":"Maintainer of flutter_inapp_purchase & expo-iap","url":"https://github.com/hyochan","page":{"permalink":"/flutter_inapp_purchase/blog/authors/hyochan"},"socials":{"x":"https://x.com/hyodotdev","github":"https://github.com/hyochan"},"imageURL":"https://github.com/hyochan.png","key":"hyochan"}],"frontMatter":{"slug":"8.0.0-release","title":"8.0.0 - Google Play Billing 8.2.0 Features","authors":["hyochan"],"tags":["release","billing-programs","breaking-change"]},"unlisted":false,"prevItem":{"title":"8.1.0 - Advanced Commerce Data & Promoted Products","permalink":"/flutter_inapp_purchase/blog/8.1.0-release"},"nextItem":{"title":"7.2.0 - Built-in Purchase Verification (aka Receipt Validation)","permalink":"/flutter_inapp_purchase/blog/release-7.2.0"}}')},94849:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var r=i(44307),a=i(74848),l=i(28453);const s={slug:"8.0.0-release",title:"8.0.0 - Google Play Billing 8.2.0 Features",authors:["hyochan"],tags:["release","billing-programs","breaking-change"]},o=void 0,t={authorsImageUrls:[void 0]},d=[{value:"What&#39;s New",id:"whats-new",level:2},{value:"Billing Programs API (Google Play Billing Library 8.2.0+)",id:"billing-programs-api-google-play-billing-library-820",level:3},{value:"One-Time Product Discounts (Google Play Billing Library 7.0+)",id:"one-time-product-discounts-google-play-billing-library-70",level:3},{value:"Purchase Suspension Status (Google Play Billing Library 8.1.0+)",id:"purchase-suspension-status-google-play-billing-library-810",level:3},{value:"Breaking Changes",id:"breaking-changes",level:2},{value:"<code>oneTimePurchaseOfferDetailsAndroid</code> is now an array",id:"onetimepurchaseofferdetailsandroid-is-now-an-array",level:3},{value:"<code>verifyPurchase</code> API changed",id:"verifypurchase-api-changed",level:3},{value:"Bug Fixes",id:"bug-fixes",level:2},{value:"Web Build Error",id:"web-build-error",level:3},{value:"Deprecated APIs",id:"deprecated-apis",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Migration Guide",id:"migration-guide",level:2},{value:"Resources",id:"resources",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["We're excited to announce flutter_inapp_purchase v8.0.0, bringing support for ",(0,a.jsx)(n.a,{href:"https://developer.android.com/google/play/billing/release-notes#8-2-0",children:"Google Play Billing Library 8.2.0"})," features including the Billing Programs API, one-time product discounts, and purchase suspension status."]}),"\n",(0,a.jsx)(n.h2,{id:"whats-new",children:"What's New"}),"\n",(0,a.jsx)(n.h3,{id:"billing-programs-api-google-play-billing-library-820",children:"Billing Programs API (Google Play Billing Library 8.2.0+)"}),"\n",(0,a.jsx)(n.p,{children:"The new Billing Programs API provides a unified way to handle external billing programs on Android, replacing the previous Alternative Billing APIs."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"import 'package:flutter_inapp_purchase/flutter_inapp_purchase.dart';\n\n// Check if external offer is available\nfinal result = await iap.isBillingProgramAvailableAndroid(\n  BillingProgramAndroid.ExternalOffer,\n);\n\nif (result.isAvailable) {\n  // Launch external link\n  await iap.launchExternalLinkAndroid(\n    LaunchExternalLinkParamsAndroid(\n      billingProgram: BillingProgramAndroid.ExternalOffer,\n      launchMode: ExternalLinkLaunchModeAndroid.LaunchInExternalBrowserOrApp,\n      linkType: ExternalLinkTypeAndroid.LinkToDigitalContentOffer,\n      linkUri: 'https://your-payment-site.com/purchase',\n    ),\n  );\n\n  // Get reporting token after external payment\n  final details = await iap.createBillingProgramReportingDetailsAndroid(\n    BillingProgramAndroid.ExternalOffer,\n  );\n\n  // Send details.externalTransactionToken to your server\n  // to report the transaction to Google Play within 24 hours\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"one-time-product-discounts-google-play-billing-library-70",children:"One-Time Product Discounts (Google Play Billing Library 7.0+)"}),"\n",(0,a.jsxs)(n.p,{children:["Products can now have multiple discount offers. The ",(0,a.jsx)(n.code,{children:"oneTimePurchaseOfferDetailsAndroid"})," field is now an array instead of a single object."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final products = await iap.fetchProducts<Product>(\n  skus: ['product_id'],\n  type: ProductQueryType.InApp,\n);\n\nfor (final product in products) {\n  final offers = product.oneTimePurchaseOfferDetailsAndroid ?? [];\n\n  for (final offer in offers) {\n    print('Offer: ${offer.offerId ?? \"default\"}');\n    print('Price: ${offer.formattedPrice}');\n\n    // Check for discount info\n    if (offer.discountDisplayInfo != null) {\n      final discount = offer.discountDisplayInfo!;\n      print('Discount: ${discount.percentageDiscount}% off');\n      if (discount.discountAmount != null) {\n        print('Save: ${discount.discountAmount!.formattedDiscountAmount}');\n      }\n    }\n\n    // Check offer validity\n    if (offer.validTimeWindow != null) {\n      final window = offer.validTimeWindow!;\n      print('Valid until: ${DateTime.fromMillisecondsSinceEpoch(\n        int.parse(window.endTimeMillis)\n      )}');\n    }\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"purchase-suspension-status-google-play-billing-library-810",children:"Purchase Suspension Status (Google Play Billing Library 8.1.0+)"}),"\n",(0,a.jsx)(n.p,{children:"You can now check if a subscription is suspended due to payment issues:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final purchases = await iap.getAvailablePurchases();\n\nfor (final purchase in purchases) {\n  if (purchase is PurchaseAndroid && purchase.isSuspendedAndroid == true) {\n    // Subscription is suspended - payment method failed\n    // Do NOT grant entitlements\n    // Direct user to Google Play to fix payment method\n    print('Subscription ${purchase.productId} is suspended');\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"breaking-changes",children:"Breaking Changes"}),"\n",(0,a.jsxs)(n.h3,{id:"onetimepurchaseofferdetailsandroid-is-now-an-array",children:[(0,a.jsx)(n.code,{children:"oneTimePurchaseOfferDetailsAndroid"})," is now an array"]}),"\n",(0,a.jsx)(n.p,{children:"This is a breaking change to support multiple discount offers per product."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Before (v7.x):"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final price = product.oneTimePurchaseOfferDetailsAndroid?.formattedPrice;\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"After (v8.x):"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final offers = product.oneTimePurchaseOfferDetailsAndroid;\nfinal price = offers?.isNotEmpty == true ? offers![0].formattedPrice : null;\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"verifypurchase-api-changed",children:[(0,a.jsx)(n.code,{children:"verifyPurchase"})," API changed"]}),"\n",(0,a.jsx)(n.p,{children:"The verification APIs now use platform-specific options objects."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Before (v7.x):"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final result = await iap.verifyPurchase(sku: 'product_id');\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"After (v8.x):"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"// iOS\nfinal result = await iap.verifyPurchase(\n  apple: VerifyPurchaseAppleOptions(sku: 'product_id'),\n);\n\n// Android\nfinal result = await iap.verifyPurchase(\n  google: VerifyPurchaseGoogleOptions(\n    sku: 'product_id',\n    accessToken: 'your-oauth-token',\n    packageName: 'com.your.app',\n    purchaseToken: purchase.purchaseToken,\n  ),\n);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"bug-fixes",children:"Bug Fixes"}),"\n",(0,a.jsx)(n.h3,{id:"web-build-error",children:"Web Build Error"}),"\n",(0,a.jsxs)(n.p,{children:["Fixed ",(0,a.jsx)(n.code,{children:"dart:io"})," import that was causing web build failures. The library now uses ",(0,a.jsx)(n.code,{children:"defaultTargetPlatform"})," from Flutter foundation instead of ",(0,a.jsx)(n.code,{children:"dart:io Platform"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Note that IAP functionality is still iOS/Android only - this fix only enables web compilation for projects that include this package."}),"\n",(0,a.jsx)(n.h2,{id:"deprecated-apis",children:"Deprecated APIs"}),"\n",(0,a.jsx)(n.p,{children:"The following APIs are deprecated in favor of the new Billing Programs API:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Deprecated"}),(0,a.jsx)(n.th,{children:"Replacement"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"checkAlternativeBillingAvailabilityAndroid()"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"isBillingProgramAvailableAndroid(BillingProgramAndroid.ExternalOffer)"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"showAlternativeBillingDialogAndroid()"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"launchExternalLinkAndroid()"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"createAlternativeBillingTokenAndroid()"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"createBillingProgramReportingDetailsAndroid(BillingProgramAndroid.ExternalOffer)"})})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,a.jsx)(n.p,{children:"Updated OpenIAP versions:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"openiap-apple"}),": ",(0,a.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap/compare/1.3.0...1.3.5",children:"1.3.0 -> 1.3.5"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"openiap-google"}),": ",(0,a.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap/compare/google-v1.3.10...google-v1.3.14",children:"1.3.10 -> 1.3.14"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"openiap-gql"}),": ",(0,a.jsx)(n.a,{href:"https://github.com/hyodotdev/openiap/compare/gql-1.3.0...gql-1.3.5",children:"1.3.0 -> 1.3.5"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"migration-guide",children:"Migration Guide"}),"\n",(0,a.jsxs)(n.p,{children:["For detailed migration instructions, see the ",(0,a.jsx)(n.a,{href:"/migration/from-v7",children:"Migration from v7"})," guide."]}),"\n",(0,a.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://developer.android.com/google/play/billing/release-notes#8-2-0",children:"Google Play Billing 8.2.0 Release Notes"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://developer.android.com/google/play/billing/billing-programs",children:"Google Play Billing Programs Documentation"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://www.openiap.dev/docs/apis",children:"OpenIAP Documentation"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);