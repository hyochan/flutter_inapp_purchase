"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[7003],{1816:e=>{e.exports=JSON.parse('{"permalink":"/flutter_inapp_purchase/blog/8.1.0-release","editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/blog/2025-12-24-8.1.0.release.md","source":"@site/blog/2025-12-24-8.1.0.release.md","title":"8.1.0 - Advanced Commerce Data & Promoted Products","description":"v8.1.0 introduces StoreKit 2\'s Advanced Commerce Data for iOS 15+ attribution tracking, improved promoted product handling, and the new google field for Android request parameters.","date":"2025-12-24T00:00:00.000Z","tags":[{"inline":false,"label":"Release","permalink":"/flutter_inapp_purchase/blog/tags/release","description":"New version releases and updates"},{"inline":false,"label":"iOS","permalink":"/flutter_inapp_purchase/blog/tags/ios","description":"Apple iOS platform updates"},{"inline":false,"label":"StoreKit 2","permalink":"/flutter_inapp_purchase/blog/tags/storekit2","description":"Apple StoreKit 2 related topics"},{"inline":false,"label":"Attribution","permalink":"/flutter_inapp_purchase/blog/tags/attribution","description":"App attribution and commerce data tracking"}],"readingTime":1.4,"hasTruncateMarker":true,"authors":[{"name":"Hyo","title":"Maintainer of flutter_inapp_purchase & expo-iap","url":"https://github.com/hyochan","page":{"permalink":"/flutter_inapp_purchase/blog/authors/hyochan"},"socials":{"x":"https://x.com/hyodotdev","github":"https://github.com/hyochan"},"imageURL":"https://github.com/hyochan.png","key":"hyochan"}],"frontMatter":{"slug":"8.1.0-release","title":"8.1.0 - Advanced Commerce Data & Promoted Products","authors":["hyochan"],"tags":["release","ios","storekit2","attribution"]},"unlisted":false,"prevItem":{"title":"8.1.2 - External Payments Program","permalink":"/flutter_inapp_purchase/blog/8.1.2-release"},"nextItem":{"title":"8.0.0 - Google Play Billing 8.2.0 Features","permalink":"/flutter_inapp_purchase/blog/8.0.0-release"}}')},28453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>a});var t=n(96540);const i={},o=t.createContext(i);function s(e){const r=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(o.Provider,{value:r},e.children)}},53603:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>t,toc:()=>c});var t=n(1816),i=n(74848),o=n(28453);const s={slug:"8.1.0-release",title:"8.1.0 - Advanced Commerce Data & Promoted Products",authors:["hyochan"],tags:["release","ios","storekit2","attribution"]},a=void 0,d={authorsImageUrls:[void 0]},c=[{value:"What&#39;s New",id:"whats-new",level:2},{value:"Advanced Commerce Data (iOS 15+)",id:"advanced-commerce-data-ios-15",level:3},{value:"Promoted Products Stream",id:"promoted-products-stream",level:3},{value:"<code>google</code> Field Support (Android)",id:"google-field-support-android",level:3},{value:"Deprecated",id:"deprecated",level:2},{value:"<code>requestPurchaseOnPromotedProductIOS()</code>",id:"requestpurchaseonpromotedproductios",level:3},{value:"<code>android</code> Field in Request Parameters",id:"android-field-in-request-parameters",level:3},{value:"Dependencies",id:"dependencies",level:2}];function l(e){const r={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.p,{children:["v8.1.0 introduces StoreKit 2's Advanced Commerce Data for iOS 15+ attribution tracking, improved promoted product handling, and the new ",(0,i.jsx)(r.code,{children:"google"})," field for Android request parameters."]}),"\n",(0,i.jsx)(r.h2,{id:"whats-new",children:"What's New"}),"\n",(0,i.jsx)(r.h3,{id:"advanced-commerce-data-ios-15",children:"Advanced Commerce Data (iOS 15+)"}),"\n",(0,i.jsxs)(r.p,{children:["StoreKit 2 introduces the ",(0,i.jsx)(r.code,{children:"Product.PurchaseOption.custom"})," API for passing attribution data during purchases. This enables campaign tracking, affiliate marketing integration, and promotional code attribution."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",children:"import 'package:flutter_inapp_purchase/flutter_inapp_purchase.dart';\n\nawait iap.requestPurchaseWithBuilder(\n  build: (builder) {\n    builder.ios.sku = 'com.example.premium';\n    builder.ios.advancedCommerceData = 'campaign_summer_2025';\n    builder.type = ProductQueryType.InApp;\n  },\n);\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Use cases:"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Campaign attribution tracking"}),"\n",(0,i.jsx)(r.li,{children:"Affiliate marketing integration"}),"\n",(0,i.jsx)(r.li,{children:"Promotional code tracking"}),"\n",(0,i.jsx)(r.li,{children:"Custom analytics data"}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"advancedCommerceData"})," field is available in both ",(0,i.jsx)(r.code,{children:"RequestPurchaseIosProps"})," and ",(0,i.jsx)(r.code,{children:"RequestSubscriptionIosProps"}),"."]}),"\n",(0,i.jsx)(r.h3,{id:"promoted-products-stream",children:"Promoted Products Stream"}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"purchasePromoted"})," stream provides a cleaner way to handle App Store promoted product purchases. When a user taps a promoted product in the App Store, this stream emits the product ID."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",children:"StreamSubscription<String?>? _promotedSubscription;\n\nvoid setupPromotedListener() {\n  _promotedSubscription = iap.purchasePromoted.listen((productId) async {\n    if (productId != null) {\n      debugPrint('User tapped promoted product: $productId');\n\n      // Purchase using standard flow\n      await iap.requestPurchaseWithBuilder(\n        build: (builder) {\n          builder.ios.sku = productId;\n          builder.type = ProductQueryType.InApp;\n        },\n      );\n    }\n  });\n}\n\n@override\nvoid dispose() {\n  _promotedSubscription?.cancel();\n  super.dispose();\n}\n"})}),"\n",(0,i.jsxs)(r.h3,{id:"google-field-support-android",children:[(0,i.jsx)(r.code,{children:"google"})," Field Support (Android)"]}),"\n",(0,i.jsxs)(r.p,{children:["Android request parameters now support the ",(0,i.jsx)(r.code,{children:"google"})," field, aligning with OpenIAP specification for consistent cross-platform naming."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",children:"// Recommended (new)\nRequestPurchasePropsByPlatforms(\n  google: RequestPurchaseAndroidProps(skus: ['sku']),\n);\n\n// Deprecated (still works)\nRequestPurchasePropsByPlatforms(\n  google: RequestPurchaseAndroidProps(skus: ['sku']),\n);\n"})}),"\n",(0,i.jsx)(r.h2,{id:"deprecated",children:"Deprecated"}),"\n",(0,i.jsx)(r.h3,{id:"requestpurchaseonpromotedproductios",children:(0,i.jsx)(r.code,{children:"requestPurchaseOnPromotedProductIOS()"})}),"\n",(0,i.jsxs)(r.p,{children:["This method is deprecated in favor of using the ",(0,i.jsx)(r.code,{children:"purchasePromoted"})," stream with the standard ",(0,i.jsx)(r.code,{children:"requestPurchase()"})," flow."]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Before (deprecated):"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",children:"await iap.requestPurchaseOnPromotedProductIOS();\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"After (recommended):"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-dart",children:"iap.purchasePromoted.listen((productId) async {\n  if (productId != null) {\n    await iap.requestPurchaseWithBuilder(\n      build: (builder) {\n        builder.ios.sku = productId;\n        builder.type = ProductQueryType.InApp;\n      },\n    );\n  }\n});\n"})}),"\n",(0,i.jsxs)(r.h3,{id:"android-field-in-request-parameters",children:[(0,i.jsx)(r.code,{children:"android"})," Field in Request Parameters"]}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"android"})," field in ",(0,i.jsx)(r.code,{children:"RequestPurchasePropsByPlatforms"})," is deprecated. Use ",(0,i.jsx)(r.code,{children:"google"})," instead for consistency with OpenIAP naming conventions."]}),"\n",(0,i.jsx)(r.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsx)(r.p,{children:"Updated OpenIAP versions:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"openiap-apple"}),": 1.3.5 -> 1.3.7"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"openiap-google"}),": 1.3.14 -> 1.3.15"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"openiap-gql"}),": 1.3.5 -> 1.3.8"]}),"\n"]})]})}function p(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);