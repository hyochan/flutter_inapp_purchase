"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[7651],{22436:e=>{e.exports=JSON.parse('{"permalink":"/flutter_inapp_purchase/blog/8.2.2-release","editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/blog/2026-01-19-8.2.2.release.md","source":"@site/blog/2026-01-19-8.2.2.release.md","title":"8.2.2 - Win-Back Offers, Product Status, and Suspended Subscriptions","description":"v8.2.2 syncs with OpenIAP v1.3.14 bringing Win-Back offers for iOS 18+, product-level status codes for Android 8.0+, and suspended subscription support.","date":"2026-01-19T00:00:00.000Z","tags":[{"inline":false,"label":"Release","permalink":"/flutter_inapp_purchase/blog/tags/release","description":"New version releases and updates"},{"inline":false,"label":"iOS","permalink":"/flutter_inapp_purchase/blog/tags/ios","description":"Apple iOS platform updates"},{"inline":false,"label":"Android","permalink":"/flutter_inapp_purchase/blog/tags/android","description":"Android platform updates"},{"inline":true,"label":"storekit","permalink":"/flutter_inapp_purchase/blog/tags/storekit"},{"inline":false,"label":"Billing","permalink":"/flutter_inapp_purchase/blog/tags/billing","description":"Google Play Billing Library updates"}],"readingTime":2.65,"hasTruncateMarker":true,"authors":[{"name":"Hyo","title":"Maintainer of flutter_inapp_purchase & expo-iap","url":"https://github.com/hyochan","page":{"permalink":"/flutter_inapp_purchase/blog/authors/hyochan"},"socials":{"x":"https://x.com/hyodotdev","github":"https://github.com/hyochan"},"imageURL":"https://github.com/hyochan.png","key":"hyochan"}],"frontMatter":{"slug":"8.2.2-release","title":"8.2.2 - Win-Back Offers, Product Status, and Suspended Subscriptions","authors":["hyochan"],"tags":["release","ios","android","storekit","billing"]},"unlisted":false,"prevItem":{"title":"8.2.3 - One-Time Purchase Discounts and Simplified Field Names","permalink":"/flutter_inapp_purchase/blog/8.2.3-release"},"nextItem":{"title":"8.2.0 - PurchaseState Cleanup and API Consolidation","permalink":"/flutter_inapp_purchase/blog/8.2.0-release"}}')},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(96540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}},71509:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>a});var i=s(22436),r=s(74848),o=s(28453);const t={slug:"8.2.2-release",title:"8.2.2 - Win-Back Offers, Product Status, and Suspended Subscriptions",authors:["hyochan"],tags:["release","ios","android","storekit","billing"]},l=void 0,d={authorsImageUrls:[void 0]},a=[{value:"New Features",id:"new-features",level:2},{value:"Win-Back Offers (iOS 18+)",id:"win-back-offers-ios-18",level:3},{value:"JWS Promotional Offers (iOS 15+, WWDC 2025)",id:"jws-promotional-offers-ios-15-wwdc-2025",level:3},{value:"Introductory Offer Eligibility Override (iOS 15+)",id:"introductory-offer-eligibility-override-ios-15",level:3},{value:"Product Status Codes (Android 8.0+)",id:"product-status-codes-android-80",level:3},{value:"Suspended Subscriptions (Android 8.1+)",id:"suspended-subscriptions-android-81",level:3},{value:"Sub-Response Codes (Android 8.0+)",id:"sub-response-codes-android-80",level:3},{value:"Builder Support for New iOS Features",id:"builder-support-for-new-ios-features",level:3},{value:"New Types",id:"new-types",level:2},{value:"Enums",id:"enums",level:3},{value:"Classes",id:"classes",level:3},{value:"Breaking Changes",id:"breaking-changes",level:2},{value:"Subscription-Only Fields Moved (iOS)",id:"subscription-only-fields-moved-ios",level:3},{value:"Dependencies",id:"dependencies",level:2},{value:"References",id:"references",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["v8.2.2 syncs with ",(0,r.jsx)(n.a,{href:"https://www.openiap.dev/docs/updates/notes#gql-1-3-14-google-1-3-25-apple-1-3-12",children:"OpenIAP v1.3.14"})," bringing Win-Back offers for iOS 18+, product-level status codes for Android 8.0+, and suspended subscription support."]}),"\n",(0,r.jsx)(n.h2,{id:"new-features",children:"New Features"}),"\n",(0,r.jsx)(n.h3,{id:"win-back-offers-ios-18",children:"Win-Back Offers (iOS 18+)"}),"\n",(0,r.jsx)(n.p,{children:"Win-back offers help re-engage churned subscribers with discounts or free trials:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"// Request subscription with win-back offer\nfinal props = RequestSubscriptionIosProps(\n  sku: 'premium_monthly',\n  winBackOffer: WinBackOfferInputIOS(offerId: 'winback_50_off'),\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"jws-promotional-offers-ios-15-wwdc-2025",children:"JWS Promotional Offers (iOS 15+, WWDC 2025)"}),"\n",(0,r.jsx)(n.p,{children:"New simplified JWS format for promotional offers, back-deployed to iOS 15:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"final props = RequestSubscriptionIosProps(\n  sku: 'premium_monthly',\n  promotionalOfferJWS: PromotionalOfferJWSInputIOS(\n    jws: 'header.payload.signature',\n    offerId: 'promo_offer_id',\n  ),\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"introductory-offer-eligibility-override-ios-15",children:"Introductory Offer Eligibility Override (iOS 15+)"}),"\n",(0,r.jsx)(n.p,{children:"Override system-determined introductory offer eligibility:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"final props = RequestSubscriptionIosProps(\n  sku: 'premium_monthly',\n  introductoryOfferEligibility: true, // Force eligible\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"product-status-codes-android-80",children:"Product Status Codes (Android 8.0+)"}),"\n",(0,r.jsx)(n.p,{children:"Products now include status codes explaining fetch results:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"final products = await iap.fetchProducts(skus: ['sku1', 'sku2']);\nfor (final product in products) {\n  if (product is ProductAndroid) {\n    switch (product.productStatusAndroid) {\n      case ProductStatusAndroid.Ok:\n        // Product fetched successfully\n        break;\n      case ProductStatusAndroid.NotFound:\n        // SKU doesn't exist in Play Console\n        break;\n      case ProductStatusAndroid.NoOffersAvailable:\n        // User not eligible for any offers\n        break;\n      case ProductStatusAndroid.Unknown:\n        // Unknown error\n        break;\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"suspended-subscriptions-android-81",children:"Suspended Subscriptions (Android 8.1+)"}),"\n",(0,r.jsx)(n.p,{children:"Include suspended subscriptions when restoring purchases:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"// Get all purchases including suspended ones\nfinal purchases = await iap.getAvailablePurchases(\n  includeSuspendedAndroid: true,\n);\n\n// Check suspension status\nfor (final purchase in purchases) {\n  if (purchase is PurchaseAndroid && purchase.isSuspendedAndroid == true) {\n    // Subscription is suspended - do NOT grant entitlements\n    // Direct user to subscription center to resolve payment issues\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"sub-response-codes-android-80",children:"Sub-Response Codes (Android 8.0+)"}),"\n",(0,r.jsxs)(n.p,{children:["More granular error information for billing operations via ",(0,r.jsx)(n.code,{children:"BillingResultAndroid"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"// BillingResultAndroid contains sub-response codes for detailed error info\n// Available when handling billing operation results\n\n// SubResponseCodeAndroid enum values:\n// - NoApplicableSubResponseCode: No specific sub-response\n// - PaymentDeclinedDueToInsufficientFunds: Payment method has insufficient funds\n// - UserIneligible: User doesn't meet offer eligibility requirements\n\n// Example: Checking sub-response code from billing result\nvoid handleBillingResult(BillingResultAndroid result) {\n  if (result.responseCode != 0) {\n    // Error occurred\n    switch (result.subResponseCode) {\n      case SubResponseCodeAndroid.PaymentDeclinedDueToInsufficientFunds:\n        // Show user-friendly message about insufficient funds\n        print('Payment failed: insufficient funds');\n        break;\n      case SubResponseCodeAndroid.UserIneligible:\n        // User doesn't qualify for this offer\n        print('You are not eligible for this offer');\n        break;\n      default:\n        print('Error: ${result.debugMessage}');\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"builder-support-for-new-ios-features",children:"Builder Support for New iOS Features"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"RequestSubscriptionIosBuilder"})," now supports all new iOS 18+ features:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"final builder = RequestSubscriptionBuilder();\nbuilder.ios\n  ..sku = 'premium_monthly'\n  ..winBackOffer = WinBackOfferInputIOS(offerId: 'winback_50_off')\n  ..promotionalOfferJWS = PromotionalOfferJWSInputIOS(\n      jws: 'header.payload.signature',\n      offerId: 'promo_offer_id',\n    )\n  ..introductoryOfferEligibility = true;\n\nawait iap.requestPurchase(builder.build());\n"})}),"\n",(0,r.jsx)(n.h2,{id:"new-types",children:"New Types"}),"\n",(0,r.jsx)(n.h3,{id:"enums",children:"Enums"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ProductStatusAndroid"})," - Product fetch status (Ok, NotFound, NoOffersAvailable, Unknown)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SubResponseCodeAndroid"})," - Detailed error codes for purchases"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SubscriptionOfferTypeIOS.WinBack"})," - New offer type for win-back offers"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"classes",children:"Classes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WinBackOfferInputIOS"})," - Win-back offer configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PromotionalOfferJWSInputIOS"})," - JWS promotional offer input"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"BillingResultAndroid"})," - Extended billing result with sub-response code"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"breaking-changes",children:"Breaking Changes"}),"\n",(0,r.jsx)(n.h3,{id:"subscription-only-fields-moved-ios",children:"Subscription-Only Fields Moved (iOS)"}),"\n",(0,r.jsxs)(n.p,{children:["The following fields have been removed from ",(0,r.jsx)(n.code,{children:"RequestPurchaseIosProps"})," and are now only available in ",(0,r.jsx)(n.code,{children:"RequestSubscriptionIosProps"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"winBackOffer"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"promotionalOfferJWS"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"introductoryOfferEligibility"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This is a type-safety improvement - these fields only apply to subscription purchases."}),"\n",(0,r.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Package"}),(0,r.jsx)(n.th,{children:"Previous"}),(0,r.jsx)(n.th,{children:"Current"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"openiap-gql"}),(0,r.jsx)(n.td,{children:"1.3.13"}),(0,r.jsx)(n.td,{children:"1.3.14"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"openiap-google"}),(0,r.jsx)(n.td,{children:"1.3.23"}),(0,r.jsx)(n.td,{children:"1.3.25"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"openiap-apple"}),(0,r.jsx)(n.td,{children:"1.3.10"}),(0,r.jsx)(n.td,{children:"1.3.12"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.openiap.dev/docs/updates/notes#gql-1-3-14-google-1-3-25-apple-1-3-12",children:"OpenIAP Release Notes"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://developer.apple.com/documentation/storekit/win-back-offers",children:"Win-Back Offers Guide"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://developer.android.com/google/play/billing/migrate-billing-8",children:"Google Billing 8.0 Migration"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);