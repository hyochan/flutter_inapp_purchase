"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[9336],{28453:(r,e,n)=>{n.d(e,{R:()=>s,x:()=>t});var o=n(96540);const a={},i=o.createContext(a);function s(r){const e=o.useContext(i);return o.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function t(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(a):r.components||a:s(r.components),o.createElement(i.Provider,{value:e},r.children)}},47815:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"api/error-codes","title":"Error Codes","description":"Comprehensive error handling reference for flutterinapppurchase v6.7.0. This guide covers all error codes, their meanings, and how to handle them effectively.","source":"@site/versioned_docs/version-6.7/api/error-codes.md","sourceDirName":"api","slug":"/api/error-codes","permalink":"/flutter_inapp_purchase/6.7/api/error-codes","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/versioned_docs/version-6.7/api/error-codes.md","tags":[],"version":"6.7","sidebarPosition":5,"frontMatter":{"title":"Error Codes","sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Listeners","permalink":"/flutter_inapp_purchase/6.7/api/listeners"},"next":{"title":"Basic Store","permalink":"/flutter_inapp_purchase/6.7/examples/basic-store"}}');var a=n(74848),i=n(28453);const s={title:"Error Codes",sidebar_position:5},t="Error Codes",d={},l=[{value:"ErrorCode Enum",id:"errorcode-enum",level:2},{value:"PurchaseError Class",id:"purchaseerror-class",level:2},{value:"Common Error Codes",id:"common-error-codes",level:2},{value:"User-Related Errors",id:"user-related-errors",level:3},{value:"UserCancelled",id:"usercancelled",level:4},{value:"UserError",id:"usererror",level:4},{value:"AlreadyOwned",id:"alreadyowned",level:4},{value:"Network &amp; Service Errors",id:"network--service-errors",level:3},{value:"NetworkError",id:"networkerror",level:4},{value:"ServiceError",id:"serviceerror",level:4},{value:"RemoteError",id:"remoteerror",level:4},{value:"Product &amp; Availability Errors",id:"product--availability-errors",level:3},{value:"ItemUnavailable",id:"itemunavailable",level:4},{value:"ProductNotFound",id:"productnotfound",level:4},{value:"Configuration &amp; Developer Errors",id:"configuration--developer-errors",level:3},{value:"DeveloperError",id:"developererror",level:4},{value:"NotInitialized",id:"notinitialized",level:4},{value:"AlreadyInitialized",id:"alreadyinitialized",level:4},{value:"Platform-Specific Mappings",id:"platform-specific-mappings",level:2},{value:"iOS Error Code Mapping",id:"ios-error-code-mapping",level:3},{value:"Android Error Code Mapping",id:"android-error-code-mapping",level:3},{value:"Error Handling Patterns",id:"error-handling-patterns",level:2},{value:"Basic Error Handler",id:"basic-error-handler",level:3},{value:"Comprehensive Error Handler",id:"comprehensive-error-handler",level:3},{value:"Retry Logic",id:"retry-logic",level:3},{value:"Error Prevention",id:"error-prevention",level:2},{value:"Best Practices",id:"best-practices",level:3},{value:"Validation Checklist",id:"validation-checklist",level:3},{value:"Debugging Error Codes",id:"debugging-error-codes",level:2},{value:"Debug Logging",id:"debug-logging",level:3},{value:"Testing Error Scenarios",id:"testing-error-scenarios",level:3},{value:"Migration Notes",id:"migration-notes",level:2},{value:"See Also",id:"see-also",level:2}];function c(r){const e={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...r.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"error-codes",children:"Error Codes"})}),"\n",(0,a.jsx)(e.p,{children:"Comprehensive error handling reference for flutter_inapp_purchase v6.7.0. This guide covers all error codes, their meanings, and how to handle them effectively."}),"\n",(0,a.jsx)(e.h2,{id:"errorcode-enum",children:"ErrorCode Enum"}),"\n",(0,a.jsx)(e.p,{children:"The standardized error codes used across both platforms."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"enum ErrorCode {\n  Unknown,                           // Unknown error\n  UserCancelled,                     // User cancelled\n  UserError,                         // User error\n  ItemUnavailable,                   // Item unavailable\n  RemoteError,                       // Remote server error\n  NetworkError,                      // Network error\n  ServiceError,                      // Service error\n  ReceiptFailed,                     // Receipt validation failed\n  ReceiptFinishedFailed,             // Receipt finish failed\n  NotPrepared,                       // Not prepared\n  NotEnded,                          // Not ended\n  AlreadyOwned,                      // Already owned\n  DeveloperError,                    // Developer error\n  BillingResponseJsonParseError,     // JSON parse error\n  DeferredPayment,                   // Deferred payment\n  Interrupted,                       // Interrupted\n  IapNotAvailable,                   // IAP not available\n  PurchaseError,                     // Purchase error\n  SyncError,                         // Sync error\n  TransactionValidationFailed,       // Transaction validation failed\n  ActivityUnavailable,               // Activity unavailable\n  AlreadyPrepared,                   // Already prepared\n  Pending,                           // Pending\n  ConnectionClosed,                  // Connection closed\n  // Additional error codes\n  BillingUnavailable,                // Billing unavailable\n  ProductAlreadyOwned,               // Product already owned\n  PurchaseNotAllowed,                // Purchase not allowed\n  QuotaExceeded,                     // Quota exceeded\n  FeatureNotSupported,               // Feature not supported\n  NotInitialized,                    // Not initialized\n  AlreadyInitialized,                // Already initialized\n  ClientInvalid,                     // Client invalid\n  PaymentInvalid,                    // Payment invalid\n  PaymentNotAllowed,                 // Payment not allowed\n  StorekitOriginalTransactionIdNotFound, // StoreKit transaction not found\n  NotSupported,                      // Not supported\n  TransactionFailed,                 // Transaction failed\n  TransactionInvalid,                // Transaction invalid\n  ProductNotFound,                   // Product not found\n  PurchaseFailed,                    // Purchase failed\n  TransactionNotFound,               // Transaction not found\n  RestoreFailed,                     // Restore failed\n  RedeemFailed,                      // Redeem failed\n  NoWindowScene,                     // No window scene\n  ShowSubscriptionsFailed,           // Show subscriptions failed\n  ProductLoadFailed,                 // Product load failed\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"purchaseerror-class",children:"PurchaseError Class"}),"\n",(0,a.jsx)(e.p,{children:"The main error class used throughout the library."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"class PurchaseError implements Exception {\n  final String name;                // Error name\n  final String message;             // Human-readable error message\n  final int? responseCode;          // Platform-specific response code\n  final String? debugMessage;       // Additional debug information\n  final ErrorCode? code;            // Standardized error code\n  final String? productId;          // Related product ID (if applicable)\n  final IAPPlatform? platform;      // Platform where error occurred\n\n  PurchaseError({\n    String? name,\n    required this.message,\n    this.responseCode,\n    this.debugMessage,\n    this.code,\n    this.productId,\n    this.platform,\n  });\n}\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Example Usage"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"try {\n  await FlutterInappPurchase.instance.requestPurchase(\n    request: request,\n    type: PurchaseType.inapp,\n  );\n} on PurchaseError catch (e) {\n  print('Error Code: ${e.code}');\n  print('Message: ${e.message}');\n  print('Platform: ${e.platform}');\n  print('Product: ${e.productId}');\n  print('Debug: ${e.debugMessage}');\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"common-error-codes",children:"Common Error Codes"}),"\n",(0,a.jsx)(e.h3,{id:"user-related-errors",children:"User-Related Errors"}),"\n",(0,a.jsx)(e.h4,{id:"usercancelled",children:"UserCancelled"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": User cancelled the purchase",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": User closes purchase dialog or cancels payment",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": No action needed - this is normal behavior",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Don't show error messages for cancellation"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.UserCancelled) {\n  // User cancelled - this is normal, don't show error\n  print('User cancelled the purchase');\n  return;\n}\n"})}),"\n",(0,a.jsx)(e.h4,{id:"usererror",children:"UserError"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": User made an error during purchase",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": Invalid payment method, insufficient funds",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": Check payment method and try again",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Show helpful message about payment methods"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.UserError) {\n  showMessage('Please check your payment method and try again.');\n}\n"})}),"\n",(0,a.jsx)(e.h4,{id:"alreadyowned",children:"AlreadyOwned"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": User already owns this product",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": Attempting to purchase owned non-consumable",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": Product is already available",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Unlock product or suggest restore purchases"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.AlreadyOwned) {\n  showMessage('You already own this item.');\n  // Optionally trigger restore purchases\n  await restorePurchases();\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"network--service-errors",children:"Network & Service Errors"}),"\n",(0,a.jsx)(e.h4,{id:"networkerror",children:"NetworkError"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": Network connectivity issues",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": No internet, poor connection, server timeout",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": Check internet connection",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Show retry option"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.NetworkError) {\n  showRetryDialog(\n    'Network error. Please check your connection and try again.',\n    onRetry: () => retryPurchase(),\n  );\n}\n"})}),"\n",(0,a.jsx)(e.h4,{id:"serviceerror",children:"ServiceError"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": Store service unavailable",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": App Store/Play Store service issues",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": Try again later",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Show temporary error message"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.ServiceError) {\n  showMessage('Store service temporarily unavailable. Please try again later.');\n}\n"})}),"\n",(0,a.jsx)(e.h4,{id:"remoteerror",children:"RemoteError"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": Remote server error",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": Store backend issues",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": Try again later",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Log for monitoring, show generic error"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.RemoteError) {\n  logError('Remote server error', error);\n  showMessage('Service temporarily unavailable. Please try again.');\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"product--availability-errors",children:"Product & Availability Errors"}),"\n",(0,a.jsx)(e.h4,{id:"itemunavailable",children:"ItemUnavailable"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": Product not available for purchase",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": Product deleted, not in current storefront",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": Contact support if expected",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Check product configuration"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.ItemUnavailable) {\n  showMessage('This item is currently unavailable.');\n  // Log for investigation\n  logError('Product unavailable: ${error.productId}', error);\n}\n"})}),"\n",(0,a.jsx)(e.h4,{id:"productnotfound",children:"ProductNotFound"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": Product ID not found in store",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": Invalid product ID, not published",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": Contact support",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Verify product ID and store configuration"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.ProductNotFound) {\n  logError('Product not found: ${error.productId}', error);\n  showMessage('Product not found. Please contact support.');\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"configuration--developer-errors",children:"Configuration & Developer Errors"}),"\n",(0,a.jsx)(e.h4,{id:"developererror",children:"DeveloperError"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": Developer configuration error",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": Invalid parameters, wrong usage",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": Contact support",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Fix implementation"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.DeveloperError) {\n  logError('Developer error: ${error.message}', error);\n  showMessage('Configuration error. Please contact support.');\n}\n"})}),"\n",(0,a.jsx)(e.h4,{id:"notinitialized",children:"NotInitialized"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": IAP not initialized",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": Calling methods before ",(0,a.jsx)(e.code,{children:"initConnection()"}),(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": None",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Call ",(0,a.jsx)(e.code,{children:"initConnection()"})," first"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.NotInitialized) {\n  await FlutterInappPurchase.instance.initConnection();\n  // Retry the operation\n}\n"})}),"\n",(0,a.jsx)(e.h4,{id:"alreadyinitialized",children:"AlreadyInitialized"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Meaning"}),": IAP already initialized",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"When it occurs"}),": Calling ",(0,a.jsx)(e.code,{children:"initConnection()"})," multiple times",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"User action"}),": None",(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.strong,{children:"Developer action"}),": Check initialization state"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"if (error.code == ErrorCode.AlreadyInitialized) {\n  // Already initialized - continue with operation\n  print('IAP already initialized');\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"platform-specific-mappings",children:"Platform-Specific Mappings"}),"\n",(0,a.jsx)(e.h3,{id:"ios-error-code-mapping",children:"iOS Error Code Mapping"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"static const Map<ErrorCode, int> ios = {\n  ErrorCode.Unknown: 0,\n  ErrorCode.ServiceError: 1,\n  ErrorCode.UserCancelled: 2,\n  ErrorCode.UserError: 3,\n  ErrorCode.ItemUnavailable: 4,\n  ErrorCode.RemoteError: 5,\n  ErrorCode.NetworkError: 6,\n  ErrorCode.ReceiptFailed: 7,\n  ErrorCode.ReceiptFinishedFailed: 8,\n  ErrorCode.DeveloperError: 9,\n  ErrorCode.PurchaseError: 10,\n  ErrorCode.SyncError: 11,\n  ErrorCode.DeferredPayment: 12,\n  ErrorCode.TransactionValidationFailed: 13,\n  ErrorCode.NotPrepared: 14,\n  ErrorCode.NotEnded: 15,\n  ErrorCode.AlreadyOwned: 16,\n  // ... additional mappings\n};\n"})}),"\n",(0,a.jsx)(e.h3,{id:"android-error-code-mapping",children:"Android Error Code Mapping"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"static const Map<ErrorCode, String> android = {\n  ErrorCode.Unknown: 'E_UNKNOWN',\n  ErrorCode.UserCancelled: 'E_USER_CANCELLED',\n  ErrorCode.UserError: 'E_USER_ERROR',\n  ErrorCode.ItemUnavailable: 'E_ITEM_UNAVAILABLE',\n  ErrorCode.RemoteError: 'E_REMOTE_ERROR',\n  ErrorCode.NetworkError: 'E_NETWORK_ERROR',\n  ErrorCode.ServiceError: 'E_SERVICE_ERROR',\n  ErrorCode.ReceiptFailed: 'E_RECEIPT_FAILED',\n  ErrorCode.AlreadyOwned: 'E_ALREADY_OWNED',\n  // ... additional mappings\n};\n"})}),"\n",(0,a.jsx)(e.h2,{id:"error-handling-patterns",children:"Error Handling Patterns"}),"\n",(0,a.jsx)(e.h3,{id:"basic-error-handler",children:"Basic Error Handler"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"class ErrorHandler {\n  static void handlePurchaseError(PurchaseError error) {\n    switch (error.code) {\n      case ErrorCode.UserCancelled:\n        // Don't show error for user cancellation\n        break;\n\n      case ErrorCode.NetworkError:\n        showRetryDialog('Network error. Please check your connection.');\n        break;\n\n      case ErrorCode.AlreadyOwned:\n        showMessage('You already own this item.');\n        restorePurchases();\n        break;\n\n      case ErrorCode.ItemUnavailable:\n        showMessage('This item is currently unavailable.');\n        break;\n\n      case ErrorCode.ServiceError:\n        showMessage('Service temporarily unavailable. Please try again later.');\n        break;\n\n      default:\n        showMessage('Purchase failed: ${error.message}');\n        logError('Unhandled purchase error', error);\n    }\n  }\n\n  static void showRetryDialog(String message) {\n    // Implementation depends on your UI framework\n  }\n\n  static void showMessage(String message) {\n    // Implementation depends on your UI framework\n  }\n\n  static void logError(String message, PurchaseError error) {\n    // Log to your analytics/monitoring service\n    print('$message: ${error.code} - ${error.message}');\n  }\n\n  static Future<void> restorePurchases() async {\n    try {\n      await FlutterInappPurchase.instance.restorePurchases();\n    } catch (e) {\n      print('Restore failed: $e');\n    }\n  }\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"comprehensive-error-handler",children:"Comprehensive Error Handler"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"class ComprehensiveErrorHandler {\n  static void handleError(dynamic error, {String? context}) {\n    if (error is PurchaseError) {\n      _handlePurchaseError(error, context: context);\n    } else if (error is PlatformException) {\n      _handlePlatformException(error, context: context);\n    } else {\n      _handleGenericError(error, context: context);\n    }\n  }\n\n  static void _handlePurchaseError(PurchaseError error, {String? context}) {\n    // Log error for analytics\n    _logError(error, context: context);\n\n    switch (error.code) {\n      case ErrorCode.UserCancelled:\n        // Silent handling - user intentionally cancelled\n        return;\n\n      case ErrorCode.NetworkError:\n        _showNetworkError();\n        break;\n\n      case ErrorCode.AlreadyOwned:\n        _handleAlreadyOwned(error.productId);\n        break;\n\n      case ErrorCode.ItemUnavailable:\n        _handleItemUnavailable(error.productId);\n        break;\n\n      case ErrorCode.ServiceError:\n      case ErrorCode.RemoteError:\n        _showServiceError();\n        break;\n\n      case ErrorCode.DeveloperError:\n      case ErrorCode.NotInitialized:\n        _handleConfigurationError(error);\n        break;\n\n      case ErrorCode.ReceiptFailed:\n      case ErrorCode.TransactionValidationFailed:\n        _handleValidationError(error);\n        break;\n\n      case ErrorCode.DeferredPayment:\n        _handleDeferredPayment();\n        break;\n\n      case ErrorCode.Pending:\n        _handlePendingPurchase();\n        break;\n\n      default:\n        _showGenericError(error.message);\n    }\n  }\n\n  static void _showNetworkError() {\n    showDialog(\n      title: 'Connection Error',\n      message: 'Please check your internet connection and try again.',\n      actions: [\n        DialogAction('Retry', onPressed: () => _retryLastOperation()),\n        DialogAction('Cancel'),\n      ],\n    );\n  }\n\n  static void _handleAlreadyOwned(String? productId) {\n    showDialog(\n      title: 'Already Purchased',\n      message: 'You already own this item. Would you like to restore your purchases?',\n      actions: [\n        DialogAction('Restore', onPressed: () => _restorePurchases()),\n        DialogAction('OK'),\n      ],\n    );\n  }\n\n  static void _handleItemUnavailable(String? productId) {\n    _logError('Product unavailable: $productId');\n    showMessage('This item is currently unavailable. Please try again later.');\n  }\n\n  static void _showServiceError() {\n    showMessage('Service temporarily unavailable. Please try again later.');\n  }\n\n  static void _handleConfigurationError(PurchaseError error) {\n    _logError('Configuration error: ${error.message}');\n    showMessage('Configuration error. Please contact support.');\n  }\n\n  static void _handleValidationError(PurchaseError error) {\n    _logError('Validation error: ${error.message}');\n    showMessage('Purchase validation failed. Please contact support.');\n  }\n\n  static void _handleDeferredPayment() {\n    showMessage(\n      'Your purchase is pending approval. You will be notified when it\\'s approved.',\n    );\n  }\n\n  static void _handlePendingPurchase() {\n    showMessage('Your purchase is being processed. Please wait...');\n  }\n\n  static void _showGenericError(String message) {\n    showMessage('Purchase failed: $message');\n  }\n\n  static void _logError(dynamic error, {String? context}) {\n    final contextStr = context != null ? '[$context] ' : '';\n    print('${contextStr}Error: $error');\n\n    // Send to analytics/monitoring service\n    // Analytics.logError(error, context: context);\n  }\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"retry-logic",children:"Retry Logic"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"class RetryLogic {\n  static const int maxRetries = 3;\n  static const Duration retryDelay = Duration(seconds: 2);\n\n  static Future<T> withRetry<T>(\n    Future<T> Function() operation, {\n    bool Function(dynamic error)? shouldRetry,\n    int maxAttempts = maxRetries,\n  }) async {\n    int attempts = 0;\n\n    while (attempts < maxAttempts) {\n      try {\n        return await operation();\n      } catch (error) {\n        attempts++;\n\n        if (attempts >= maxAttempts) {\n          rethrow;\n        }\n\n        // Check if we should retry this error\n        if (shouldRetry != null && !shouldRetry(error)) {\n          rethrow;\n        }\n\n        // Only retry on specific errors\n        if (error is PurchaseError) {\n          switch (error.code) {\n            case ErrorCode.NetworkError:\n            case ErrorCode.ServiceError:\n            case ErrorCode.RemoteError:\n              // Retry these errors\n              await Future.delayed(retryDelay * attempts);\n              continue;\n            default:\n              // Don't retry other errors\n              rethrow;\n          }\n        }\n\n        rethrow;\n      }\n    }\n\n    throw Exception('Max retry attempts exceeded');\n  }\n}\n\n// Usage example\nFuture<void> makePurchaseWithRetry(String productId) async {\n  try {\n    await RetryLogic.withRetry(() async {\n      final request = RequestPurchase(\n        ios: RequestPurchaseIOS(sku: productId, quantity: 1),\n        android: RequestPurchaseAndroid(skus: [productId]),\n      );\n\n      await FlutterInappPurchase.instance.requestPurchase(\n        request: request,\n        type: PurchaseType.inapp,\n      );\n    });\n  } catch (e) {\n    ComprehensiveErrorHandler.handleError(e, context: 'purchase');\n  }\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"error-prevention",children:"Error Prevention"}),"\n",(0,a.jsx)(e.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Always Initialize"}),": Call ",(0,a.jsx)(e.code,{children:"initConnection()"})," before other operations"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Handle All Errors"}),": Implement comprehensive error handling"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"User-Friendly Messages"}),": Show helpful messages, not technical details"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Log for Monitoring"}),": Track errors for analysis and improvement"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Graceful Degradation"}),": Continue app functionality when IAP fails"]}),"\n"]}),"\n",(0,a.jsx)(e.h3,{id:"validation-checklist",children:"Validation Checklist"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"class ValidationHelper {\n  static Future<bool> validateBeforePurchase(String productId) async {\n    try {\n      // Check if IAP is initialized\n      if (!FlutterInappPurchase.instance._isInitialized) {\n        await FlutterInappPurchase.instance.initConnection();\n      }\n\n      // Check if product exists\n      final result = await FlutterInappPurchase.instance.fetchProducts(\n        ProductRequest(\n          skus: [productId],\n          type: ProductQueryType.InApp,\n        ),\n      );\n      final products = result.inAppProducts();\n      if (products.isEmpty) {\n        throw PurchaseError(\n          code: ErrorCode.ProductNotFound,\n          message: 'Product not found: $productId',\n        );\n      }\n\n      // Check if already owned (for non-consumables)\n      final availablePurchases = await FlutterInappPurchase.instance.getAvailablePurchases();\n      if (availablePurchases.any((p) => p.productId == productId)) {\n        throw PurchaseError(\n          code: ErrorCode.AlreadyOwned,\n          message: 'Product already owned: $productId',\n        );\n      }\n\n      return true;\n    } catch (e) {\n      ComprehensiveErrorHandler.handleError(e, context: 'validation');\n      return false;\n    }\n  }\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"debugging-error-codes",children:"Debugging Error Codes"}),"\n",(0,a.jsx)(e.h3,{id:"debug-logging",children:"Debug Logging"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"class ErrorDebugger {\n  static void logDetailedError(PurchaseError error) {\n    print('=== Purchase Error Debug Info ===');\n    print('Code: ${error.code}');\n    print('Message: ${error.message}');\n    print('Response Code: ${error.responseCode}');\n    print('Debug Message: ${error.debugMessage}');\n    print('Product ID: ${error.productId}');\n    print('Platform: ${error.platform}');\n    print('Platform Code: ${error.getPlatformCode()}');\n    print('================================');\n  }\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"testing-error-scenarios",children:"Testing Error Scenarios"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-dart",children:"class ErrorTesting {\n  static Future<void> testErrorScenarios() async {\n    // Test network error\n    await _testNetworkError();\n\n    // Test invalid product\n    await _testInvalidProduct();\n\n    // Test user cancellation\n    await _testUserCancellation();\n  }\n\n  static Future<void> _testNetworkError() async {\n    // Simulate network error conditions\n  }\n\n  static Future<void> _testInvalidProduct() async {\n    try {\n      await FlutterInappPurchase.instance.fetchProducts(\n        ProductRequest(\n          skus: ['invalid_product_id'],\n          type: ProductQueryType.InApp,\n        ),\n      );\n    } catch (e) {\n      print('Expected error for invalid product: $e');\n    }\n  }\n\n  static Future<void> _testUserCancellation() async {\n    // Test cancellation flow\n  }\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"migration-notes",children:"Migration Notes"}),"\n",(0,a.jsxs)(e.p,{children:["\u26a0\ufe0f ",(0,a.jsx)(e.strong,{children:"Breaking Changes from v5.x:"})]}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Error Types"}),": ",(0,a.jsx)(e.code,{children:"PurchaseError"})," replaces simple error strings"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Error Codes"}),": New ",(0,a.jsx)(e.code,{children:"ErrorCode"})," enum for standardized handling"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Platform Codes"}),": Access via ",(0,a.jsx)(e.code,{children:"getPlatformCode()"})," method"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Null Safety"}),": All error fields are properly nullable"]}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"see-also",children:"See Also"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.a,{href:"/flutter_inapp_purchase/6.7/api/core-methods",children:"Core Methods"})," - Methods that can throw these errors"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.a,{href:"/flutter_inapp_purchase/6.7/api/listeners",children:"Listeners"})," - Error event streams"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.a,{href:"/flutter_inapp_purchase/6.7/guides/troubleshooting",children:"Troubleshooting Guide"})," - Solving common issues"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.a,{href:"/flutter_inapp_purchase/6.7/api/types",children:"Types"})," - Error data structures"]}),"\n"]})]})}function h(r={}){const{wrapper:e}={...(0,i.R)(),...r.components};return e?(0,a.jsx)(e,{...r,children:(0,a.jsx)(c,{...r})}):c(r)}}}]);