"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[8586],{23745:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/iapkit-c59e6aa8685ab25efc4c1df21f39f51a.png"},27856:(e,i,n)=>{n.d(i,{I:()=>r,V:()=>t});const t="https://iapkit.com",r="https://www.hyo.dev/api/ad-banner/cmjf0l1x30001249hbi91aop6"},28453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>l});var t=n(96540);const r={},a=t.createContext(r);function s(e){const i=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(a.Provider,{value:i},e.children)}},39086:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>d});var t=n(62289),r=n(74848),a=n(28453),s=n(71437);const l={slug:"release-7.2.0",title:"7.2.0 - Built-in Purchase Verification (aka Receipt Validation)",authors:["hyochan"],tags:["release","iapkit","verification","backend","security"],description:"Flutter In-App Purchase 7.2.0 brings built-in purchase verification (aka receipt validation) powered by IAPKit. Verify purchases with enterprise-grade backend validation using a single API call-no server setup required.",image:"/img/iapkit.png",date:new Date("2025-12-09T00:00:00.000Z")},c="Flutter In-App Purchase 7.2.0",o={authorsImageUrls:[void 0]},d=[{value:"Why IAPKit?",id:"why-iapkit",level:2},{value:"Key Benefits",id:"key-benefits",level:3},{value:"Getting Started",id:"getting-started",level:2},{value:"Highlights",id:"highlights",level:2},{value:"Type System Updates",id:"type-system-updates",level:2},{value:"New <code>IapStore</code> Enum",id:"new-iapstore-enum",level:3},{value:"Updated Purchase Types",id:"updated-purchase-types",level:3},{value:"Request Parameters",id:"request-parameters",level:3},{value:"Migration from 7.1",id:"migration-from-71",level:2},{value:"Store Field",id:"store-field",level:3},{value:"Verification Integration",id:"verification-integration",level:3},{value:"Installation",id:"installation",level:2},{value:"References",id:"references",level:2},{value:"What&#39;s Next?",id:"whats-next",level:2}];function p(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{children:(0,r.jsx)(i.img,{alt:"IAPKit Integration",src:n(23745).A+"",width:"1024",height:"1024"})}),"\n",(0,r.jsxs)(i.p,{children:["Flutter In-App Purchase 7.2.0 brings ",(0,r.jsx)(i.strong,{children:"built-in purchase verification"})," (aka receipt validation) powered by ",(0,r.jsx)(s.A,{children:"IAPKit"}),". Now you can verify purchases with enterprise-grade backend validation using a single API call-no server setup required."]}),"\n",(0,r.jsx)(i.h2,{id:"why-iapkit",children:"Why IAPKit?"}),"\n",(0,r.jsxs)(i.p,{children:["Purchase verification is critical for any production IAP implementation. Without proper server-side validation, your app is vulnerable to receipt tampering, replay attacks, and fraudulent transactions. ",(0,r.jsx)(s.A,{children:"IAPKit"})," solves this with a battle-tested backend infrastructure. Sign up at ",(0,r.jsx)(s.A,{children:"iapkit.com"})," to get your API key and start verifying purchases in minutes."]}),"\n",(0,r.jsx)(i.h3,{id:"key-benefits",children:"Key Benefits"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{style:{textAlign:"center"}}),(0,r.jsx)(i.th,{style:{textAlign:"left"},children:"Benefit"}),(0,r.jsx)(i.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{style:{textAlign:"center"},children:(0,r.jsx)(i.strong,{children:"Security First"})}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:"Server-side validation that prevents fraud, receipt tampering, and token reuse. Far more secure than client-only verification."}),(0,r.jsx)(i.td,{style:{textAlign:"left"}})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{style:{textAlign:"center"},children:(0,r.jsx)(i.strong,{children:"Unified API"})}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:"Single endpoint for both Apple App Store and Google Play. No separate validation logic needed."}),(0,r.jsx)(i.td,{style:{textAlign:"left"}})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{style:{textAlign:"center"},children:(0,r.jsx)(i.strong,{children:"Zero Infrastructure"})}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:"No server setup required. IAPKit handles Apple and Google API complexity for you."}),(0,r.jsx)(i.td,{style:{textAlign:"left"}})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{style:{textAlign:"center"},children:(0,r.jsx)(i.strong,{children:"Production Ready"})}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:"Enterprise-grade reliability with comprehensive error handling and detailed responses."}),(0,r.jsx)(i.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,r.jsxs)(i.p,{children:["Use the new ",(0,r.jsx)(i.code,{children:"verifyPurchaseWithProvider"})," API to verify purchases through IAPKit:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-dart",children:"import 'package:flutter_inapp_purchase/flutter_inapp_purchase.dart';\n\nfinal result = await iap.verifyPurchaseWithProvider(\n  VerifyPurchaseWithProviderProps(\n    provider: VerifyPurchaseProvider.iapkit,\n    iapkit: RequestVerifyPurchaseWithIapkitProps(\n      apiKey: 'your-iapkit-api-key',\n      apple: RequestVerifyPurchaseWithIapkitAppleProps(jws: purchase.purchaseToken),\n      google: RequestVerifyPurchaseWithIapkitGoogleProps(\n          purchaseToken: purchase.purchaseToken),\n    ),\n  ),\n);\n\nif (result.iapkit case final iapkit? when iapkit.isValid) {\n  // Purchase verified - grant entitlement\n  print('Purchase state: ${iapkit.state}');\n  print('Store: ${iapkit.store}');\n}\n"})}),"\n",(0,r.jsxs)(i.p,{children:["The API returns a unified ",(0,r.jsx)(i.code,{children:"VerifyPurchaseWithProviderResult"})," with:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"isValid"})," - Whether the purchase passed verification"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"state"})," - Detailed purchase state (entitled, pending, expired, canceled, etc.)"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"store"})," - The store where the purchase was made (apple, google, horizon)"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"highlights",children:"Highlights"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"IAPKit Integration"})," - Built-in purchase verification (aka receipt validation) with enterprise-grade backend"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"https://www.openiap.dev/docs/updates/announcements#2025-12-09",children:"OpenIAP 1.3.0"})})," - Updated to openiap-apple v1.3.0, openiap-google v1.3.10, and openiap-gql v1.3.0"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsxs)(i.strong,{children:["New ",(0,r.jsx)(i.code,{children:"IapStore"})," Type"]})," - Unified store identification: ",(0,r.jsx)(i.code,{children:"unknown"}),", ",(0,r.jsx)(i.code,{children:"apple"}),", ",(0,r.jsx)(i.code,{children:"google"}),", ",(0,r.jsx)(i.code,{children:"horizon"})]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Enhanced Purchase Types"})," - New ",(0,r.jsx)(i.code,{children:"store"})," field on Purchase (replaces deprecated ",(0,r.jsx)(i.code,{children:"platform"}),")"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"type-system-updates",children:"Type System Updates"}),"\n",(0,r.jsx)(i.p,{children:"This release brings important type refinements aligned with the OpenIAP 1.3.0 specification:"}),"\n",(0,r.jsxs)(i.h3,{id:"new-iapstore-enum",children:["New ",(0,r.jsx)(i.code,{children:"IapStore"})," Enum"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-dart",children:"enum IapStore {\n  unknown,\n  apple,\n  google,\n  horizon,\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"updated-purchase-types",children:"Updated Purchase Types"}),"\n",(0,r.jsxs)(i.p,{children:["All purchase types now include a ",(0,r.jsx)(i.code,{children:"store"})," field for unified store identification:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-dart",children:"final purchase = PurchaseIOS(\n  productId: 'premium',\n  transactionId: '12345',\n  store: IapStore.apple, // NEW - unified store identification\n  // ...other fields\n);\n"})}),"\n",(0,r.jsx)(i.h3,{id:"request-parameters",children:"Request Parameters"}),"\n",(0,r.jsxs)(i.p,{children:["Request parameters now support ",(0,r.jsx)(i.code,{children:"apple"}),"/",(0,r.jsx)(i.code,{children:"google"})," keys alongside the legacy ",(0,r.jsx)(i.code,{children:"ios"}),"/",(0,r.jsx)(i.code,{children:"android"}),":"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-dart",children:"// New (recommended)\nawait iap.requestPurchase(\n  RequestPurchaseProps(\n    apple: RequestPurchasePropsApple(sku: productId),\n    google: RequestPurchasePropsGoogle(skus: [productId]),\n  ),\n);\n\n// Legacy (still supported but deprecated)\nawait iap.requestPurchase(\n  RequestPurchaseProps(\n    ios: RequestPurchasePropsIos(sku: productId),\n    android: RequestPurchasePropsAndroid(skus: [productId]),\n  ),\n);\n"})}),"\n",(0,r.jsx)(i.h2,{id:"migration-from-71",children:"Migration from 7.1"}),"\n",(0,r.jsx)(i.h3,{id:"store-field",children:"Store Field"}),"\n",(0,r.jsxs)(i.p,{children:["If you're checking platform-specific purchases, consider using the new ",(0,r.jsx)(i.code,{children:"store"})," field:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-dart",children:"// Before (7.1)\nif (purchase.platform == 'ios') {\n  // Handle iOS purchase\n}\n\n// After (7.2)\nif (purchase.store == IapStore.apple) {\n  // Handle Apple purchase\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"verification-integration",children:"Verification Integration"}),"\n",(0,r.jsx)(i.p,{children:"Add purchase verification to your existing purchase flow:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-dart",children:"// After successful purchase\npurchaseUpdatedStream.listen((purchase) async {\n  if (purchase.productId != null) {\n    // Verify the purchase - send both apple and google props\n    // The backend will use the appropriate one based on the store\n    final verification = await iap.verifyPurchaseWithProvider(\n      VerifyPurchaseWithProviderProps(\n        provider: VerifyPurchaseProvider.iapkit,\n        iapkit: RequestVerifyPurchaseWithIapkitProps(\n          apiKey: 'your-api-key',\n          apple: RequestVerifyPurchaseWithIapkitAppleProps(jws: purchase.purchaseToken),\n          google: RequestVerifyPurchaseWithIapkitGoogleProps(\n              purchaseToken: purchase.purchaseToken),\n        ),\n      ),\n    );\n\n    if (verification.iapkit case final iapkit? when iapkit.isValid) {\n      // Grant entitlement\n      await grantPurchase(purchase.productId!);\n\n      // Finish the transaction\n      await iap.finishTransaction(purchase);\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(i.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-yaml",children:"dependencies:\n  flutter_inapp_purchase: ^7.2.0\n"})}),"\n",(0,r.jsx)(i.p,{children:"Then run:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"flutter pub get\n"})}),"\n",(0,r.jsx)(i.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(s.A,{path:"/docs",children:"IAPKit Documentation"}),"\n"]}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/api/core-methods#verifypurchasewithprovider",children:"verifyPurchaseWithProvider API"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"https://openiap.dev",children:"OpenIAP Ecosystem"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/migration/from-v7.1",children:"Migration Guide from 7.1"})}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"whats-next",children:"What's Next?"}),"\n",(0,r.jsx)(i.p,{children:"We continue to focus on:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Enhanced verification workflows"}),"\n",(0,r.jsx)(i.li,{children:"Better error handling and retry mechanisms"}),"\n",(0,r.jsx)(i.li,{children:"Subscription lifecycle management"}),"\n",(0,r.jsx)(i.li,{children:"Community feedback and improvements"}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["Questions or feedback? Reach out via ",(0,r.jsx)(i.a,{href:"https://github.com/hyochan/flutter_inapp_purchase/issues",children:"GitHub Issues"})," or join our ",(0,r.jsx)(i.a,{href:"https://hyo.dev/joinSlack",children:"Slack community"}),"."]})]})}function h(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},62289:e=>{e.exports=JSON.parse('{"permalink":"/flutter_inapp_purchase/blog/release-7.2.0","editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/blog/2025-12-09-7.2.0.release.md","source":"@site/blog/2025-12-09-7.2.0.release.md","title":"7.2.0 - Built-in Purchase Verification (aka Receipt Validation)","description":"Flutter In-App Purchase 7.2.0 brings built-in purchase verification (aka receipt validation) powered by IAPKit. Verify purchases with enterprise-grade backend validation using a single API call-no server setup required.","date":"2025-12-09T00:00:00.000Z","tags":[{"inline":false,"label":"Release","permalink":"/flutter_inapp_purchase/blog/tags/release","description":"New version releases and updates"},{"inline":false,"label":"IAPKit","permalink":"/flutter_inapp_purchase/blog/tags/iapkit","description":"IAPKit integration for purchase verification"},{"inline":false,"label":"Verification","permalink":"/flutter_inapp_purchase/blog/tags/verification","description":"Purchase verification and receipt validation"},{"inline":false,"label":"Backend","permalink":"/flutter_inapp_purchase/blog/tags/backend","description":"Backend integration and server-side features"},{"inline":false,"label":"Security","permalink":"/flutter_inapp_purchase/blog/tags/security","description":"Security features and best practices"}],"readingTime":3.08,"hasTruncateMarker":true,"authors":[{"name":"Hyo","title":"Maintainer of flutter_inapp_purchase & expo-iap","url":"https://github.com/hyochan","page":{"permalink":"/flutter_inapp_purchase/blog/authors/hyochan"},"socials":{"x":"https://x.com/hyodotdev","github":"https://github.com/hyochan"},"imageURL":"https://github.com/hyochan.png","key":"hyochan"}],"frontMatter":{"slug":"release-7.2.0","title":"7.2.0 - Built-in Purchase Verification (aka Receipt Validation)","authors":["hyochan"],"tags":["release","iapkit","verification","backend","security"],"description":"Flutter In-App Purchase 7.2.0 brings built-in purchase verification (aka receipt validation) powered by IAPKit. Verify purchases with enterprise-grade backend validation using a single API call-no server setup required.","image":"/img/iapkit.png","date":"2025-12-09T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"8.0.0 - Google Play Billing 8.2.0 Features","permalink":"/flutter_inapp_purchase/blog/8.0.0-release"},"nextItem":{"title":"7.1.13 - Horizon OS Support for Meta Quest Devices","permalink":"/flutter_inapp_purchase/blog/horizon-os-support"}}')},71437:(e,i,n)=>{n.d(i,{A:()=>a});n(96540);var t=n(27856),r=n(74848);function a({children:e,path:i=""}){return(0,r.jsx)("a",{href:`${t.V}${i}`,target:"_blank",rel:"noopener noreferrer",onClick:async()=>{try{await fetch(t.I,{method:"POST",mode:"no-cors"})}catch(e){}},children:e})}}}]);