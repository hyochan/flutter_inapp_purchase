"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[767],{5896:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>d,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"api/methods/get-products","title":"fetchProducts","description":"fetchProducts() is the unified way to load in-app products or subscriptions from the store, consolidating the legacy helpers into a single API.","source":"@site/versioned_docs/version-6.8/api/methods/get-products.md","sourceDirName":"api/methods","slug":"/api/methods/get-products","permalink":"/flutter_inapp_purchase/docs/6.8/api/methods/get-products","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/versioned_docs/version-6.8/api/methods/get-products.md","tags":[],"version":"6.8","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"fetchProducts"}}');var t=r(4848),i=r(8453);const d={sidebar_position:2,title:"fetchProducts"},c="fetchProducts()",l={},o=[{value:"Signature",id:"signature",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Return Value",id:"return-value",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Fetch in-app products",id:"fetch-in-app-products",level:3},{value:"Fetch subscriptions",id:"fetch-subscriptions",level:3},{value:"Fetch both types",id:"fetch-both-types",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Platform Notes",id:"platform-notes",level:2},{value:"iOS",id:"ios",level:3},{value:"Android",id:"android",level:3},{value:"Migration Notes",id:"migration-notes",level:2},{value:"Related APIs",id:"related-apis",level:2},{value:"See Also",id:"see-also",level:2}];function a(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"fetchproducts",children:"fetchProducts()"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"fetchProducts()"})," is the unified way to load in-app products or subscriptions from the store, consolidating the legacy helpers into a single API."]}),"\n",(0,t.jsx)(s.h2,{id:"signature",children:"Signature"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"Future<FetchProductsResult> fetchProducts(ProductRequest params)\n"})}),"\n",(0,t.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Required"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"params.skus"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"List<String>"})}),(0,t.jsx)(s.td,{children:"\u2705"}),(0,t.jsx)(s.td,{children:"Store identifiers to query (Google Play product IDs / App Store product identifiers)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"params.type"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"ProductQueryType?"})}),(0,t.jsx)(s.td,{children:"\u274c"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"ProductQueryType.InApp"})," (default) or ",(0,t.jsx)(s.code,{children:"ProductQueryType.Subs"})]})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"return-value",children:"Return Value"}),"\n",(0,t.jsxs)(s.p,{children:["The method returns a ",(0,t.jsx)(s.code,{children:"FetchProductsResult"})," union type:"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"FetchProductsResultProducts:"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Contains ",(0,t.jsx)(s.code,{children:".value"})," property with ",(0,t.jsx)(s.code,{children:"List<Product>?"})," (nullable list)"]}),"\n",(0,t.jsxs)(s.li,{children:["Returned for ",(0,t.jsx)(s.code,{children:"ProductQueryType.InApp"})," queries"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"FetchProductsResultSubscriptions:"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Contains ",(0,t.jsx)(s.code,{children:".value"})," property with ",(0,t.jsx)(s.code,{children:"List<ProductSubscription>?"})," (nullable list)"]}),"\n",(0,t.jsxs)(s.li,{children:["Returned for ",(0,t.jsx)(s.code,{children:"ProductQueryType.Subs"})," queries"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Important:"})," Always access the product list via the ",(0,t.jsx)(s.code,{children:".value"})," property:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"final result = await fetchProducts(...);\nfinal products = result.value ?? []; // Handle nullable list\n"})}),"\n",(0,t.jsx)(s.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,t.jsx)(s.h3,{id:"fetch-in-app-products",children:"Fetch in-app products"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"final result = await FlutterInappPurchase.instance.fetchProducts(\n  ProductRequest(\n    skus: ['coins_100', 'remove_ads'],\n    type: ProductQueryType.InApp,\n  ),\n);\n\nfor (final product in result.value) {\n  print('${product.title}: ${product.displayPrice}');\n}\n"})}),"\n",(0,t.jsx)(s.h3,{id:"fetch-subscriptions",children:"Fetch subscriptions"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"final result = await FlutterInappPurchase.instance.fetchProducts(\n  ProductRequest(\n    skus: ['premium_monthly', 'premium_yearly'],\n    type: ProductQueryType.Subs,\n  ),\n);\n\nfor (final sub in result.value) {\n  print('${sub.title}: ${sub.displayPrice}');\n  print('Period: ${sub.subscriptionPeriodUnitIOS ?? sub.subscriptionInfoAndroid?.billingPeriod}');\n}\n"})}),"\n",(0,t.jsx)(s.h3,{id:"fetch-both-types",children:"Fetch both types"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"Future<void> loadCatalog() async {\n  final inAppsResult = await FlutterInappPurchase.instance.fetchProducts(\n    ProductRequest(skus: ['coins_100', 'remove_ads'], type: ProductQueryType.InApp),\n  );\n  final subsResult = await FlutterInappPurchase.instance.fetchProducts(\n    ProductRequest(skus: ['premium_monthly'], type: ProductQueryType.Subs),\n  );\n\n  final allProducts = [\n    ...inAppsResult.value ?? [],\n    ...subsResult.value ?? [],\n  ];\n\n  for (final item in allProducts) {\n    debugPrint('Loaded ${item.id} (${item.displayPrice})');\n  }\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"try {\n  final result = await FlutterInappPurchase.instance.fetchProducts(\n    ProductRequest(skus: productIds, type: ProductQueryType.InApp),\n  );\n  if (result.value.isEmpty) {\n    debugPrint('No products returned for: $productIds');\n  }\n  if (result.invalidProductIds.isNotEmpty) {\n    debugPrint('Invalid product IDs: ${result.invalidProductIds}');\n  }\n} on PurchaseError catch (error) {\n  switch (error.code) {\n    case 'E_NOT_PREPARED':\n      debugPrint('Call initConnection() before fetching products');\n      break;\n    case 'E_NETWORK_ERROR':\n      debugPrint('Network error \u2013 prompt the user to retry');\n      break;\n    default:\n      debugPrint('Unexpected store error: ${error.message}');\n  }\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"platform-notes",children:"Platform Notes"}),"\n",(0,t.jsx)(s.h3,{id:"ios",children:"iOS"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Products must be visible in App Store Connect (Ready for Sale or Approved)"}),"\n",(0,t.jsx)(s.li,{children:"The bundle identifier must match the app querying the products"}),"\n",(0,t.jsx)(s.li,{children:"StoreKit 2 caching means results may be served from a local cache on subsequent calls"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"android",children:"Android"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Products must be active in Google Play Console (Internal Testing track or above)"}),"\n",(0,t.jsx)(s.li,{children:"Billing client v8 requires the app to be signed with a certificate added to Play Console"}),"\n",(0,t.jsx)(s.li,{children:"Only SKUs that belong to the current package can be queried"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"migration-notes",children:"Migration Notes"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Replace ",(0,t.jsx)(s.code,{children:"requestProducts()"})," calls with ",(0,t.jsx)(s.code,{children:"fetchProducts(ProductRequest(...))"})]}),"\n",(0,t.jsxs)(s.li,{children:["Convert the returned ",(0,t.jsx)(s.code,{children:"FetchProductsResult"})," using ",(0,t.jsx)(s.code,{children:"inAppProducts()"}),", ",(0,t.jsx)(s.code,{children:"subscriptionProducts()"}),", or ",(0,t.jsx)(s.code,{children:"allProducts()"})," depending on the query type"]}),"\n",(0,t.jsxs)(s.li,{children:["Replace any legacy product-loading helpers in your codebase with ",(0,t.jsx)(s.code,{children:"fetchProducts()"})]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"related-apis",children:"Related APIs"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"./request-purchase",children:(0,t.jsx)(s.code,{children:"requestPurchase()"})})," \u2013 Start the purchase flow"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"./get-available-purchases",children:(0,t.jsx)(s.code,{children:"getAvailablePurchases()"})})," \u2013 Restore owned items"]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"../../guides/products#fetchproducts-helper-extensions",children:[(0,t.jsx)(s.code,{children:"fetchProducts()"})," helper extensions"]})}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../guides/products",children:"Products Guide"})," \u2013 Designing product catalogs"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../guides/subscriptions",children:"Subscriptions Guide"})," \u2013 Subscription-specific flows"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../troubleshooting",children:"Troubleshooting"})," \u2013 Diagnostics for common failures"]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,s,r)=>{r.d(s,{R:()=>d,x:()=>c});var n=r(6540);const t={},i=n.createContext(t);function d(e){const s=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);